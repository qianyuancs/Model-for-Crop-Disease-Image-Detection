解决问题背景：[Problem B：Research on Crop Leaf Disease.pdf](https://github.com/user-attachments/files/23599121/Problem.B.Research.on.Crop.Leaf.Disease.pdf)

以下是本项目解决的四个核心问题：
数据清洗与模型构建：给出的基于61类病害图像数据，通过移除无效数据进行数据预处理，构建高效的高精度轻量级病害分类模型，并运用恰当的增强策略提高精确度。 
小样本病害识别：构建并优化深度学习模型，实现在每类仅10张随机训练图像的极端条件下，对61类病害进行分类。
病害严重程度分级预测：构建一个深度学习模型，实现依据叶片图像预测作物病害的严重程度，并对模型进行过程性展示与全面化评估。
多任务联合学习与可解释诊断：开发一个集成的综合诊断深度学习系统，对输入的作物图像进行病害类别与严重程度的多任务识别，并生成可读诊断报告。最终，评估该系统的协同效应是否优于先前的单功能模型。

对于模型的选择，基于参数大小和训练效率的要求，综合作物病害叶片的图像特变，我们选择ResNet50模型进行训练，并针对不均衡训练样本提出自适应增强策略，最后对其结果进行对比评估。结合准确率、训练损失等指标，最终确定ResNet50模型的有效性。

我们在完成少量样本选择与自适应优化的基础上，尝试利用迁移学习构建稳健的特征表示基础，通过元学习机制获得少样本快速适应能力。具体地，我们采用EfficientNet-B0作为预训练骨干网络，继承其在大规模图像数据集上学到的通用视觉特征，同时满足model parameter不超过20M的要求。其次我们引入原型网络作为元学习器，为每个少样本病害类别构建动态原型表示。通过冻结-解冻微调两阶段训练策略，模型在保护预训练知识的同时，逐步适应目标样本的特征分布。

在问题三中，为了实现对于作物疾病严重程度的分级识别，将其分为healthy, general, severe三个程度，我们基于问题一已训练好的ResNet50模型进行调整并训练。我们将训练集样本按照作物种类与疾病情况进行二维分类，记录各类别的数量统计，在此基础上进行不同的样本数层次的分级自增强策略。
	在训练过程中，为了避免灾难性遗忘，我们冻结骨干网络的特征提取器，只训练适配器，并设计了Adapter方法将2048维特征向量压缩至512维特征向量以匹配三维分类。在模型优化方面，采用了AdamW优化器进行参数更新。并创新性地提出动态样本权重调整体系，依据前5轮的召回率调整类别权重，以平衡样本数量分布不均。
	运用公式输出model accuracy, macro-averaged F1-score, and recall rate for each category，验证模型有效性。

为了实现任务四中一个能够同时完成疾病分类和严重程度分级的多任务学习系统的构建，我们基于问题三训练好的ResNet50模型构建，将它改进成多任务架构。我们创新性设计渐进式解冻网络组件，确保模型先分别掌握基础的疾病类型与严重程度识别任务，再进行联合全局微调。
	针对要求中的包含置信度等关键信息的可读诊断报告的生成，我们构建分层建议体系，为每个样本提供疾病预测及其置信度、最终诊断结果、严重程度评估以及相应的防治建议。报告生成逻辑基于Softmax概率计算各类别的预测置信度，并根据严重程度等级（健康、一般、严重）动态生成差异化的防治建议。
	为了评估多任务学习的协同效应，我们量化对比了渐进训练的三个阶段输出结果与问题一和问题三的单任务输出结果，进一步计算了F1分数的协同增益，提供了更全面的性能评估。
