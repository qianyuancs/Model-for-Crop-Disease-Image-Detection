2025-11-15 16:59:50,408 INFO Starting train_task3_v3
2025-11-15 16:59:50,646 INFO Loaded 31541 train samples, 4533 val samples
2025-11-15 16:59:51,189 INFO Loaded backbone weights (fc excluded) from C:\Users\21978\Desktop\大学\赛程知识\数模赛\数维杯\Question1\checkpoints\resnet50_best.pth
2025-11-15 17:29:03,958 INFO [Epoch 1] Train Loss=0.1890 Acc=0.8531 MacroF1=0.8660 Recalls=[0.97190367 0.82984346 0.81231751]
2025-11-15 17:33:27,029 INFO [Epoch 1] Val Loss=0.3832 Acc=0.8420 MacroF1=0.8535 Recalls=[0.94884654 0.75583864 0.8492699 ]
2025-11-15 17:33:27,042 INFO Validation classification report:
              precision    recall  f1-score   support

     Healthy     0.9693    0.9488    0.9589       997
     General     0.7607    0.7558    0.7583      1413
     Serious     0.8374    0.8493    0.8433      2123

    accuracy                         0.8420      4533
   macro avg     0.8558    0.8513    0.8535      4533
weighted avg     0.8425    0.8420    0.8422      4533

2025-11-15 17:33:27,045 INFO Adjusted weights: General mean=0.9467
2025-11-15 17:33:27,220 INFO Saved new best model to ./checkpoints_task3_v3\best_model_task3_v3.pth (macroF1=0.8535)
2025-11-15 18:12:08,603 INFO [Epoch 2] Train Loss=0.1541 Acc=0.8769 MacroF1=0.8894 Recalls=[0.98451835 0.86054076 0.83689821]
2025-11-15 18:17:38,740 INFO [Epoch 2] Val Loss=0.3702 Acc=0.8542 MacroF1=0.8651 Recalls=[0.97893681 0.74663836 0.8671691 ]
2025-11-15 18:17:38,766 INFO Validation classification report:
              precision    recall  f1-score   support

     Healthy     0.9692    0.9789    0.9741       997
     General     0.7903    0.7466    0.7678      1413
     Serious     0.8403    0.8672    0.8535      2123

    accuracy                         0.8542      4533
   macro avg     0.8666    0.8642    0.8651      4533
weighted avg     0.8530    0.8542    0.8533      4533

2025-11-15 18:17:38,766 INFO Adjusted weights: General mean=0.9941
2025-11-15 18:17:39,060 INFO Saved new best model to ./checkpoints_task3_v3\best_model_task3_v3.pth (macroF1=0.8651)
2025-11-15 18:57:15,884 INFO [Epoch 3] Train Loss=0.1487 Acc=0.8808 MacroF1=0.8933 Recalls=[0.98623853 0.87416141 0.83520065]
2025-11-15 19:02:49,251 INFO [Epoch 3] Val Loss=0.4289 Acc=0.8288 MacroF1=0.8424 Recalls=[0.89368104 0.80962491 0.81111634]
2025-11-15 19:02:49,266 INFO Validation classification report:
              precision    recall  f1-score   support

     Healthy     0.9878    0.8937    0.9384       997
     General     0.7168    0.8096    0.7604      1413
     Serious     0.8462    0.8111    0.8283      2123

    accuracy                         0.8288      4533
   macro avg     0.8503    0.8381    0.8424      4533
weighted avg     0.8370    0.8288    0.8313      4533

2025-11-15 19:02:49,268 INFO Adjusted weights: General mean=0.9941
2025-11-15 19:42:46,692 INFO [Epoch 4] Train Loss=0.1388 Acc=0.8848 MacroF1=0.8971 Recalls=[0.98695528 0.8821915  0.83805256]
2025-11-15 19:46:42,828 INFO [Epoch 4] Val Loss=0.3432 Acc=0.8562 MacroF1=0.8709 Recalls=[0.96890672 0.82661005 0.82289213]
2025-11-15 19:46:42,843 INFO Validation classification report:
              precision    recall  f1-score   support

     Healthy     0.9877    0.9689    0.9782       997
     General     0.7506    0.8266    0.7868      1413
     Serious     0.8739    0.8229    0.8476      2123

    accuracy                         0.8562      4533
   macro avg     0.8708    0.8728    0.8709      4533
weighted avg     0.8605    0.8562    0.8574      4533

2025-11-15 19:46:42,843 INFO Adjusted weights: General mean=0.9941
2025-11-15 19:46:43,083 INFO Saved new best model to ./checkpoints_task3_v3\best_model_task3_v3.pth (macroF1=0.8709)
2025-11-15 20:16:46,194 INFO [Epoch 5] Train Loss=0.1315 Acc=0.8919 MacroF1=0.9035 Recalls=[0.99039564 0.88707054 0.84850954]
2025-11-15 20:20:28,765 INFO [Epoch 5] Val Loss=0.3524 Acc=0.8566 MacroF1=0.8705 Recalls=[0.95887663 0.82802548 0.82760245]
2025-11-15 20:20:28,778 INFO Validation classification report:
              precision    recall  f1-score   support

     Healthy     0.9896    0.9589    0.9740       997
     General     0.7457    0.8280    0.7847      1413
     Serious     0.8794    0.8276    0.8527      2123

    accuracy                         0.8566      4533
   macro avg     0.8716    0.8715    0.8705      4533
weighted avg     0.8620    0.8566    0.8582      4533

2025-11-15 20:20:28,779 INFO Adjusted weights: General mean=0.9941
2025-11-15 20:49:33,166 INFO [Epoch 6] Train Loss=0.1266 Acc=0.8945 MacroF1=0.9061 Recalls=[0.99025229 0.889815   0.85231208]
2025-11-15 20:53:41,691 INFO [Epoch 6] Val Loss=0.3775 Acc=0.8487 MacroF1=0.8634 Recalls=[0.98796389 0.81316348 0.80687706]
2025-11-15 20:53:41,706 INFO Validation classification report:
              precision    recall  f1-score   support

     Healthy     0.9647    0.9880    0.9762       997
     General     0.7389    0.8132    0.7743      1413
     Serious     0.8753    0.8069    0.8397      2123

    accuracy                         0.8487      4533
   macro avg     0.8597    0.8693    0.8634      4533
weighted avg     0.8525    0.8487    0.8493      4533

2025-11-15 21:24:36,392 INFO [Epoch 7] Train Loss=0.1177 Acc=0.9005 MacroF1=0.9114 Recalls=[0.99182913 0.89276276 0.86249745]
2025-11-15 21:28:26,208 INFO [Epoch 7] Val Loss=0.3888 Acc=0.8509 MacroF1=0.8670 Recalls=[0.99197593 0.83722576 0.79368818]
2025-11-15 21:28:26,221 INFO Validation classification report:
              precision    recall  f1-score   support

     Healthy     0.9725    0.9920    0.9821       997
     General     0.7316    0.8372    0.7809      1413
     Serious     0.8873    0.7937    0.8379      2123

    accuracy                         0.8509      4533
   macro avg     0.8638    0.8743    0.8670      4533
weighted avg     0.8575    0.8509    0.8518      4533

2025-11-15 21:58:58,380 INFO [Epoch 8] Train Loss=0.1172 Acc=0.9022 MacroF1=0.9130 Recalls=[0.99139908 0.89560886 0.86439872]
2025-11-15 22:02:39,519 INFO [Epoch 8] Val Loss=0.3540 Acc=0.8522 MacroF1=0.8683 Recalls=[0.98294885 0.85067233 0.79180405]
2025-11-15 22:02:39,533 INFO Validation classification report:
              precision    recall  f1-score   support

     Healthy     0.9761    0.9829    0.9795       997
     General     0.7316    0.8507    0.7866      1413
     Serious     0.8913    0.7918    0.8386      2123

    accuracy                         0.8522      4533
   macro avg     0.8663    0.8751    0.8683      4533
weighted avg     0.8602    0.8522    0.8534      4533

2025-11-15 22:35:10,200 INFO [Epoch 9] Train Loss=0.1088 Acc=0.9056 MacroF1=0.9162 Recalls=[0.99340596 0.9052653  0.86419502]
2025-11-15 22:39:55,121 INFO [Epoch 9] Val Loss=0.3807 Acc=0.8518 MacroF1=0.8677 Recalls=[0.97993982 0.86270347 0.78426755]
2025-11-15 22:39:55,141 INFO Validation classification report:
              precision    recall  f1-score   support

     Healthy     0.9741    0.9799    0.9770       997
     General     0.7239    0.8627    0.7872      1413
     Serious     0.9020    0.7843    0.8390      2123

    accuracy                         0.8518      4533
   macro avg     0.8666    0.8756    0.8677      4533
weighted avg     0.8623    0.8518    0.8532      4533

2025-11-15 23:14:17,813 INFO [Epoch 10] Train Loss=0.1054 Acc=0.9105 MacroF1=0.9203 Recalls=[0.99354931 0.90455377 0.87505941]
2025-11-15 23:19:35,407 INFO [Epoch 10] Val Loss=0.3917 Acc=0.8484 MacroF1=0.8654 Recalls=[0.98395186 0.84996461 0.78379651]
2025-11-15 23:19:35,431 INFO Validation classification report:
              precision    recall  f1-score   support

     Healthy     0.9790    0.9840    0.9815       997
     General     0.7231    0.8500    0.7814      1413
     Serious     0.8898    0.7838    0.8335      2123

    accuracy                         0.8484      4533
   macro avg     0.8640    0.8726    0.8654      4533
weighted avg     0.8575    0.8484    0.8498      4533

2025-11-16 00:10:28,901 INFO [Epoch 11] Train Loss=0.1029 Acc=0.9110 MacroF1=0.9211 Recalls=[0.99455275 0.90567188 0.87505941]
2025-11-16 00:14:55,365 INFO [Epoch 11] Val Loss=0.3774 Acc=0.8582 MacroF1=0.8723 Recalls=[0.98595787 0.81174805 0.82901554]
2025-11-16 00:14:55,386 INFO Validation classification report:
              precision    recall  f1-score   support

     Healthy     0.9781    0.9860    0.9820       997
     General     0.7601    0.8117    0.7851      1413
     Serious     0.8717    0.8290    0.8498      2123

    accuracy                         0.8582      4533
   macro avg     0.8700    0.8756    0.8723      4533
weighted avg     0.8603    0.8582    0.8587      4533

2025-11-16 00:14:55,670 INFO Saved new best model to ./checkpoints_task3_v3\best_model_task3_v3.pth (macroF1=0.8723)
2025-11-16 00:48:51,074 INFO [Epoch 12] Train Loss=0.0962 Acc=0.9157 MacroF1=0.9252 Recalls=[0.99512615 0.90851799 0.8829361 ]
2025-11-16 00:53:25,174 INFO [Epoch 12] Val Loss=0.3979 Acc=0.8507 MacroF1=0.8676 Recalls=[0.98395186 0.84713376 0.79039096]
2025-11-16 00:53:25,190 INFO Validation classification report:
              precision    recall  f1-score   support

     Healthy     0.9830    0.9840    0.9835       997
     General     0.7281    0.8471    0.7831      1413
     Serious     0.8874    0.7904    0.8361      2123

    accuracy                         0.8507      4533
   macro avg     0.8661    0.8738    0.8676      4533
weighted avg     0.8587    0.8507    0.8520      4533

2025-11-16 01:21:25,280 INFO [Epoch 13] Train Loss=0.0949 Acc=0.9164 MacroF1=0.9259 Recalls=[0.9952695  0.91024598 0.88313981]
2025-11-16 01:25:07,678 INFO [Epoch 13] Val Loss=0.3942 Acc=0.8562 MacroF1=0.8719 Recalls=[0.98395186 0.84288747 0.80499293]
2025-11-16 01:25:07,693 INFO Validation classification report:
              precision    recall  f1-score   support

     Healthy     0.9820    0.9840    0.9830       997
     General     0.7421    0.8429    0.7893      1413
     Serious     0.8860    0.8050    0.8435      2123

    accuracy                         0.8562      4533
   macro avg     0.8700    0.8773    0.8719      4533
weighted avg     0.8622    0.8562    0.8573      4533

2025-11-16 01:43:42,662 INFO [Epoch 14] Train Loss=0.0917 Acc=0.9201 MacroF1=0.9291 Recalls=[0.99569954 0.91339703 0.88884362]
2025-11-16 01:46:08,953 INFO [Epoch 14] Val Loss=0.4035 Acc=0.8564 MacroF1=0.8712 Recalls=[0.97191575 0.83651805 0.81535563]
2025-11-16 01:46:08,962 INFO Validation classification report:
              precision    recall  f1-score   support

     Healthy     0.9828    0.9719    0.9773       997
     General     0.7476    0.8365    0.7896      1413
     Serious     0.8805    0.8154    0.8467      2123

    accuracy                         0.8564      4533
   macro avg     0.8703    0.8746    0.8712      4533
weighted avg     0.8616    0.8564    0.8576      4533

2025-11-16 02:03:43,924 INFO [Epoch 15] Train Loss=0.0889 Acc=0.9211 MacroF1=0.9300 Recalls=[0.99569954 0.91410856 0.89040538]
2025-11-16 02:06:22,783 INFO [Epoch 15] Val Loss=0.3854 Acc=0.8601 MacroF1=0.8751 Recalls=[0.98094283 0.83793347 0.81818182]
2025-11-16 02:06:22,792 INFO Validation classification report:
              precision    recall  f1-score   support

     Healthy     0.9849    0.9809    0.9829       997
     General     0.7532    0.8379    0.7933      1413
     Serious     0.8826    0.8182    0.8492      2123

    accuracy                         0.8601      4533
   macro avg     0.8736    0.8790    0.8751      4533
weighted avg     0.8648    0.8601    0.8612      4533

2025-11-16 02:06:22,918 INFO Saved new best model to ./checkpoints_task3_v3\best_model_task3_v3.pth (macroF1=0.8751)
2025-11-16 02:06:22,919 INFO Training finished.
2025-11-16 02:06:22,919 INFO Best val macro-F1: 0.8751, saved at: ./checkpoints_task3_v3\best_model_task3_v3.pth
